<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <title>觀看總覽</title>
  <link rel="stylesheet" href="styles.css">
  <script type="module">
    import { loadLocal, weekLabel, getCurrentWeekStartISO } from './app.js';
    const db = loadLocal();
    const list = document.getElementById('overviewList');

    function getWatched(animeId) {
      const eps = new Set();
      db.logs.forEach(l => {
        if (l.animeId === animeId) l.eps.forEach(e => eps.add(e));
      });
      return Array.from(eps);
    }

    function render() {
      list.innerHTML = db.items.map(a => {
        const watched = getWatched(a.id);
        const done = watched.length >= a.episodes;
        return `<li class="card">
          <h3>${a.name}</h3>
          <p>觀看進度：<span class="${done ? 'complete' : ''}">${watched.length}/${a.episodes}</span></p>
        </li>`;
      }).join('');
    }

    window.onload = render;
  </script>
</head>
<body>
  <header class="site-header container">
    <a class="brand" href="index.html">⬅ 返回首頁</a>
    <nav class="nav">
      <a href="dashboard.html">動畫紀錄</a>
      <a href="manage.html">動畫登記</a>
      <a href="overview.html">觀看總覽</a>
    </nav>
  </header>

  <main class="container">
    <section class="section">
      <h2>觀看總覽</h2>
      <ul id="overviewList" class="grid"></ul>
    </section>
  </main>
</body>
</html>
